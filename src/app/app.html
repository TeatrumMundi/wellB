<!-- Clean background with welcome image -->

<div
  class="h-screen flex flex-col items-center justify-center relative bg-cover bg-center bg-no-repeat gap-12"
  style="background-image: url('/welcome.png'); background-attachment: scroll"
>
  <!-- Green overlay -->
  <div
    class="absolute inset-0 bg-gradient-to-br from-green-800/10 via-green-600/10 to-green-500/10 pointer-events-none"
  ></div>

  <div
    class="text-center p-8 bg-white/95 rounded-3xl shadow-2xl backdrop-blur-md border border-green-300/30 max-w-2xl mx-auto relative z-10"
  >
    <h1 class="text-5xl font-light mb-4 text-green-800 drop-shadow-sm font-sans">
      Welcome to {{ title() }}
    </h1>
    <p class="text-xl text-green-700 m-0 opacity-90 font-light">Find your peace and tranquility</p>
  </div>

  <div class="flex justify-center items-center relative z-10">
    <button
      class="bg-gradient-to-br from-green-400 to-green-500 text-white border-none px-10 py-4 text-lg rounded-full cursor-pointer transition-all duration-300 shadow-lg hover:shadow-xl hover:-translate-y-0.5 hover:from-green-500 hover:to-green-600 active:translate-y-0 font-medium inline-flex items-center gap-2 tracking-wide"
      (click)="scrollToContent()"
    >
      Get Started
      <span class="text-xl animate-bounce">↓</span>
    </button>
  </div>
</div>

<div
  class="min-h-screen py-4 md:py-20 px-2 md:px-8 bg-gradient-to-b from-green-50/95 to-green-100/95 backdrop-blur-sm flex items-center"
  #contentSection
>
  <!-- Calendar Section -->
  <div
    class="w-full max-w-7xl mx-auto p-3 md:p-12 bg-white/90 rounded-xl md:rounded-3xl shadow-2xl border border-green-300/30 backdrop-blur-md flex flex-col h-full"
  >
    <div class="text-center mb-4 md:mb-8">
      <h2 class="text-green-800 text-2xl md:text-4xl font-light m-0 drop-shadow-sm">
        {{ getCurrentMonthYear() }}
      </h2>
    </div>

    <!-- Calendar Table -->
    <div
      class="bg-green-50/60 rounded-xl md:rounded-2xl p-2 md:p-6 border border-green-200/30 flex-1 flex items-center justify-center overflow-auto"
    >
      <table
        class="border-separate border-spacing-1 md:border-spacing-4 table-fixed mx-auto h-full w-full max-w-none"
      >
        <!-- Days of the Week Header -->
        <thead>
          <tr>
            <th class="calendar-weekday-header">Mon</th>
            <th class="calendar-weekday-header">Tue</th>
            <th class="calendar-weekday-header">Wed</th>
            <th class="calendar-weekday-header">Thu</th>
            <th class="calendar-weekday-header">Fri</th>
            <th class="calendar-weekday-header">Sat</th>
            <th class="calendar-weekday-header">Sun</th>
          </tr>
        </thead>

        <!-- Calendar Days -->
        <tbody>
          @for (week of getCalendarWeeks(); track $index) {
          <tr>
            @for (day of week; track day?.date || $index) {
            <td
              class="calendar-day"
              (click)="onDayClick(day)"
              [class]="
                day && !day.isCurrentMonth
                  ? 'text-green-300 bg-white/40 hover:bg-green-200/30'
                  : day && day.isToday
                  ? 'bg-gradient-to-br from-green-400 to-green-500 text-white font-semibold shadow-lg border-green-500 hover:from-green-500 hover:to-green-600 hover:shadow-xl hover:-translate-y-0.5'
                  : !day
                  ? 'bg-transparent border-none cursor-default hover:bg-transparent hover:translate-y-0 hover:shadow-none'
                  : ''
              "
            >
              <div class="absolute inset-0 flex flex-col p-1 md:p-2">
                <!-- Day number at the top -->
                <div class="text-xs lg:text-lg font-bold mb-0.5 md:mb-1">
                  {{ day?.day || '' }}
                </div>

                <!-- Wellness info below -->
                @if (day) {
                <div class="flex-1 flex flex-col justify-center">
                  <!-- If user has data show it, otherwise show a darker 'Click to add' hint -->
                  @if (hasDataForDay(day.date)) {
                  <div
                    class="bg-green-200 rounded-sm md:rounded-md p-0.5 md:p-1 text-xs text-blue-600 font-medium space-y-0 md:space-y-0.5"
                  >
                    <div class="flex items-center justify-between text-xs md:text-xs">
                      <span class="text-xs">💧</span>
                      <span class="text-right text-xs">
                        {{ getDayData(day.date)?.water || 0
                        }}<span class="hidden sm:inline"
                          >/
                          {{
                            formatCompact(getDayData(day.date)?.waterGoal) || formatCompact(2)
                          }}</span
                        >L
                      </span>
                    </div>
                    <div class="flex items-center justify-between text-xs md:text-xs">
                      <span class="text-xs">🏃</span>
                      <span class="text-right text-xs">
                        {{ getDayData(day.date)?.steps || 0
                        }}<span class="hidden sm:inline"
                          >/
                          {{
                            formatCompact(getDayData(day.date)?.stepsGoal) || formatCompact(10000)
                          }}</span
                        >
                      </span>
                    </div>
                  </div>
                  } @if (!hasDataForDay(day.date)) {
                  <div
                    class="bg-transparent rounded-sm md:rounded-md p-1 text-xs text-gray-700 font-medium italic click-to-add"
                  >
                    Click to add
                  </div>
                  }
                </div>
                }
              </div>
            </td>
            }
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>

<router-outlet />

<!-- Day Editor Modal -->
@if (selectedDay) {
<div class="fixed inset-0 z-50 flex items-center justify-center">
  <div class="absolute inset-0 bg-black/50" (click)="closeEditor()"></div>
  <div class="bg-white rounded-xl z-10 w-[90%] max-w-md mx-auto relative overflow-hidden">
    <div
      class="bg-emerald-600 w-full h-15 relative flex items-center justify-center text-white"
    >
      <!-- Left-top: Delete  -->
      <button
        class="absolute left-3 top-3 inline-flex items-center justify-center w-9 h-9 rounded-xl bg-red-200 hover:bg-red-200/70 transition-colors duration-300 cursor-pointer"
        title="Clear day"
        (click)="clearSelectedDay()"
        aria-label="Clear day"
      >
        <span class="material-icons text-red-600" aria-hidden="true">delete_forever</span>
      </button>

      <!-- Right-top: Close  -->
      <button
        class="absolute right-1/48 top-3 inline-flex items-center justify-center w-9 h-9 rounded-xl bg-gray-200 hover:bg-gray-200/70 transition-colors duration-300 cursor-pointer"
        title="Close"
        (click)="closeEditor()"
        aria-label="Close editor"
      >
        <span class="material-icons text-gray-700" aria-hidden="true">clear</span>
      </button>

      <!-- Right-top: Close  -->
      <button
        class="absolute right-3/24 top-3 inline-flex items-center justify-center w-9 h-9 rounded-xl bg-emerald-200 hover:bg-emerald-200/70 transition-colors duration-300 cursor-pointer"
        title="Save"
        (click)="saveData()"
        aria-label="Save changes and close editor"
      >
        <span class="material-icons text-gray-700" aria-hidden="true">add</span>
      </button>


      <!-- Day number display -->
      <h3 class="text-lg font-semibold">{{ selectedDay.day }} {{ getCurrentMonthYear() }}</h3>
    </div>

    <div class="p-6 space-y-3">
      <div>
        <mat-form-field  class="w-full">
          <mat-label>Water | Goal: {{ formatCompact(editingData.waterGoal) }} L</mat-label>
          <input
            matInput
            type="number"
            step="0.1"
            [(ngModel)]="editingData.water"
            aria-label="Water in liters"
          />
          <mat-hint align="start"></mat-hint>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field  class="w-full">
          <mat-label>Steps | Goal: {{ formatCompact(editingData.stepsGoal) }}</mat-label>
          <input matInput type="number" [(ngModel)]="editingData.steps" aria-label="Steps count" />
        </mat-form-field>
      </div>
    </div>
  </div>
</div>
}
